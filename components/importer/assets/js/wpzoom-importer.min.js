jQuery(function(o){function a(s,e){0===e.length?u(p("import")):(s.addClass("iss-button-disabled"),c(e,0,s,!0,!1))}function t(t){var s,i=jQuery.Deferred();return s=jQuery.Deferred(),n.addClass(e),setTimeout(function(){n.removeClass(e).hide(),s.resolve()},r),s.promise().done(function(){var s=t,e=i;s="all"!==s&&s?'[data-categories*="'+s+'"]':"div",n.filter(s).show().addClass("iss-is-fadein"),setTimeout(function(){n.removeClass(l),e.resolve()},r)}),i}var n,e,l,r;function d(s,e,t){return t.indexOf(s)===e}function c(s,e,t,i,n){var a=s[e].name;o.ajax({method:"POST",url:iss.ajax_url,data:{action:"iss_install_plugin",security:iss.ajax_nonce,slug:a},beforeSend:function(){var s=o(".plugin-item-"+a);s.find(".js-iss-plugin-item-info").empty(),s.find(".js-iss-plugin-item-error").empty(),s.addClass("plugin-item--loading")}}).done(function(s){var e=o(".plugin-item-"+a);e.removeClass("plugin-item--loading"),s.success?(e.addClass("plugin-item--active"),e.find("input[type=checkbox]").prop("disabled",!0)):(-1===s.data.indexOf("<p>")&&(s.data="<p>"+s.data+"</p>"),e.find(".js-iss-plugin-item-error").append(s.data),e.find("input[type=checkbox]").prop("checked",!1),n=!0)}).fail(function(s){var e=o(".plugin-item-"+a);e.removeClass("plugin-item--loading"),e.find(".js-iss-plugin-item-error").append("<p>"+s.statusText+" ("+s.status+")</p>"),n=!0}).always(function(){++e===s.length?(i&&(n?alert(iss.texts.plugin_install_failed):u(p("import"))),t.removeClass("iss-button-disabled")):c(s,e,t,i,n)})}function p(s){for(var e,t=window.location.search.substring(1).split("&"),i=0;i<t.length;i++)if((e=t[i].split("="))[0]===s)return e[1],decodeURIComponent(e[1]);return!1}function u(s){var e=new FormData;e.append("action","iss_import_demo_data"),e.append("security",iss.ajax_nonce),s&&e.append("selected",s),function t(i){o.ajax({method:"POST",url:iss.ajax_url,data:i,contentType:!1,processData:!1,beforeSend:function(){o(".js-iss-install-plugins-content").hide(),o(".js-iss-importing").show()}}).done(function(s){var e;void 0!==s.status&&"newAJAX"===s.status?t(i):void 0!==s.status&&"customizerAJAX"===s.status?((e=new FormData).append("action","iss_import_customizer_data"),e.append("security",iss.ajax_nonce),!0===iss.wp_customize_on&&e.append("wp_customize","on"),t(e)):void 0!==s.status&&"afterAllImportAJAX"===s.status?((e=new FormData).append("action","iss_after_import_data"),e.append("security",iss.ajax_nonce),t(e)):void 0!==s.message?(o(".js-iss-ajax-complete-response").append(s.message),void 0!==s.title&&o(".js-iss-ajax-response-title").html(s.title),void 0!==s.subtitle&&o(".js-iss-ajax-response-subtitle").html(s.subtitle),o(".js-iss-importing").hide(),o(".js-iss-imported").show(),o(document).trigger("issImportComplete")):(o(".js-iss-ajax-complete-response").append('<img class="iss-imported-content-imported iss-imported-content-imported--error" src="'+iss.plugin_url+'assets/images/error.svg" alt="'+iss.texts.import_failed+'"><p>'+s+"</p>"),o(".js-iss-ajax-response-title").html(iss.texts.import_failed),o(".js-iss-ajax-response-subtitle").html("<p>"+iss.texts.import_failed_subtitle+"</p>"),o(".js-iss-importing").hide(),o(".js-iss-imported").show())}).fail(function(s){o(".js-iss-ajax-complete-response").append('<img class="iss-imported-content-imported iss-imported-content-imported--error" src="'+iss.plugin_url+'assets/images/error.svg" alt="'+iss.texts.import_failed+'"><p>Error: '+s.statusText+" ("+s.status+")</p>"),o(".js-iss-ajax-response-title").html(iss.texts.import_failed),o(".js-iss-ajax-response-subtitle").html("<p>"+iss.texts.import_failed_subtitle+"</p>"),o(".js-iss-importing").hide(),o(".js-iss-imported").show()})}(e)}o(".js-iss-notice-wrapper").appendTo(".js-iss-admin-notices-container"),o("#tabs").tabs(),o(".iss-install-plugins-content-content .plugin-item.plugin-item--required input[type=checkbox]").on("click",function(s){return s.preventDefault(),!1}),o(".js-iss-install-plugins").on("click",function(s){s.preventDefault();var e,s=o(this);return!s.hasClass("iss-button-disabled")&&0!==(e=o(".iss-install-plugins-content-content .plugin-item input[type=checkbox]").serializeArray()).length&&(s.addClass("iss-button-disabled"),void c(e,0,s,!1,!1))}),o(".js-iss-install-plugins-before-import").on("click",function(s){s.preventDefault();var e=o(this);if(e.hasClass("iss-button-disabled"))return!1;var t,i,s=o(".iss-install-theme-content"),n=o(".iss-install-plugins-content-content .plugin-item:not(.plugin-item--disabled) input[type=checkbox]").serializeArray();void 0!==s&&0<s.length&&(t=s.find("input[type=checkbox]:checked").val(),i=s.find(".theme-item"),void 0!==t)&&0<t.length?o.ajax({method:"POST",url:iss.ajax_url,data:{action:"handle_inspiro_theme",security:iss.ajax_nonce},beforeSend:function(){i.addClass("theme-item--loading")}}).done(function(s){if(i.removeClass("theme-item--loading"),s.success)return i.addClass("theme-item--active"),i.find("input[type=checkbox]").prop("disabled",!0),a(e,n),console.log("Theme activated successfully."),!1;console.log(s.data||"Failed to activate theme."),e.removeClass("iss-button-disabled")}).fail(function(s){console.log("Error: "+s.statusText+" ("+s.status+")"),a(e,n)}):a(e,n)}),o(document).on("change",".iss--create-content .content-item input[type=checkbox]",function(s){var e=o(".iss--create-content .content-item input[type=checkbox]"),t=o(".js-iss-create-content-install-plugins-notice"),i=[];e.each(function(){var e,t,s=o(this);s.is(":checked")&&(i=i.concat((e=(e=s.data("plugins")).split(","),t=[],iss.missing_plugins.forEach(function(s){-1!==e.indexOf(s.slug)&&t.push(s.name)}),t)))}),0<(i=i.filter(d).join(", ")).length?(t.find(".js-iss-create-content-install-plugins-list").text(i),t.show()):(t.find(".js-iss-create-content-install-plugins-list").text(""),t.hide())}),o(".js-iss-delete-imported-demo").on("click",function(s){s.preventDefault();s=o(this);if(s.hasClass("iss-button-disabled"))return!1;s.addClass("iss-button-disabled"),o.ajax({method:"POST",url:iss.ajax_url,data:{action:"iss_delete_imported_demo",security:iss.ajax_nonce},beforeSend:function(){o(".js-iss-delete-imported-content").hide(),o(".js-iss-deleting").show()}}).done(function(s){s.success||console.log(s.data||"Failed to delete imported content."),o(".js-iss-deleting").hide(),o(".js-iss-deleted").show()})}),n=o(".js-iss-gl-item-container").find(".js-iss-gl-item"),e="iss-is-fadeout",l="iss-is-fadein",r=200,o(".js-iss-nav-link").on("click",function(s){s.preventDefault(),o(this).parent().siblings().removeClass("active"),o(this).parent().addClass("active");var s=this.hash.slice(1),e=o(".js-iss-gl-item-container");e.css("min-width",e.outerHeight()),t(s).done(function(){e.removeAttr("style")})}),o(".js-iss-gl-search").on("keyup",function(s){(0<o(this).val().length?(o(".js-iss-gl-item-container").find(".js-iss-gl-item").hide(),o(".js-iss-gl-item-container").find('.js-iss-gl-item[data-name*="'+o(this).val().toLowerCase()+'"]')):o(".js-iss-gl-item-container").find(".js-iss-gl-item")).show()})});