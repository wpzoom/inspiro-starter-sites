jQuery(function(a){function n(t,s){0===s.length?u(c("import")):(t.addClass("inspiro-starter-sites-button-disabled"),d(s,0,t,!0,!1))}function e(e){var t,i=jQuery.Deferred();return t=jQuery.Deferred(),r.addClass(s),setTimeout(function(){r.removeClass(s).hide(),t.resolve()},p),t.promise().done(function(){var t=e,s=i;t="all"!==t&&t?'[data-categories*="'+t+'"]':"div",r.filter(t).show().addClass("inspiro-starter-sites-is-fadein"),setTimeout(function(){r.removeClass(o),s.resolve()},p)}),i}var r,s,o,p;function l(t,s,e){return e.indexOf(t)===s}function d(t,s,e,i,r){var n=t[s].name;a.ajax({method:"POST",url:inspiro_starter_sites.ajax_url,data:{action:"inspiro_starter_sites_install_plugin",security:inspiro_starter_sites.ajax_nonce,slug:n},beforeSend:function(){var t=a(".plugin-item-"+n);t.find(".js-inspiro-starter-sites-plugin-item-info").empty(),t.find(".js-inspiro-starter-sites-plugin-item-error").empty(),t.addClass("plugin-item--loading")}}).done(function(t){var s=a(".plugin-item-"+n);s.removeClass("plugin-item--loading"),t.success?(s.addClass("plugin-item--active"),s.find("input[type=checkbox]").prop("disabled",!0)):(-1===t.data.indexOf("<p>")&&(t.data="<p>"+t.data+"</p>"),s.find(".js-inspiro-starter-sites-plugin-item-error").append(t.data),s.find("input[type=checkbox]").prop("checked",!1),r=!0)}).fail(function(t){var s=a(".plugin-item-"+n);s.removeClass("plugin-item--loading"),s.find(".js-inspiro-starter-sites-plugin-item-error").append("<p>"+t.statusText+" ("+t.status+")</p>"),r=!0}).always(function(){++s===t.length?(i&&(r?alert(inspiro_starter_sites.texts.plugin_install_failed):u(c("import"))),e.removeClass("inspiro-starter-sites-button-disabled")):d(t,s,e,i,r)})}function c(t){for(var s,e=window.location.search.substring(1).split("&"),i=0;i<e.length;i++)if((s=e[i].split("="))[0]===t)return s[1],decodeURIComponent(s[1]);return!1}function u(t){var s=new FormData;s.append("action","inspiro_starter_sites_import_demo_data"),s.append("security",inspiro_starter_sites.ajax_nonce),t&&s.append("selected",t),function e(i){a.ajax({method:"POST",url:inspiro_starter_sites.ajax_url,data:i,contentType:!1,processData:!1,beforeSend:function(){a(".js-inspiro-starter-sites-install-plugins-content").hide(),a(".js-inspiro-starter-sites-importing").show()}}).done(function(t){var s;void 0!==t.status&&"newAJAX"===t.status?e(i):void 0!==t.status&&"customizerAJAX"===t.status?((s=new FormData).append("action","inspiro_starter_sites_import_customizer_data"),s.append("security",inspiro_starter_sites.ajax_nonce),!0===inspiro_starter_sites.wp_customize_on&&s.append("wp_customize","on"),e(s)):void 0!==t.status&&"afterAllImportAJAX"===t.status?((s=new FormData).append("action","inspiro_starter_sites_after_import_data"),s.append("security",inspiro_starter_sites.ajax_nonce),e(s)):void 0!==t.message?(a(".js-inspiro-starter-sites-ajax-complete-response").append(t.message),void 0!==t.title&&a(".js-inspiro-starter-sites-ajax-response-title").html(t.title),void 0!==t.subtitle&&a(".js-inspiro-starter-sites-ajax-response-subtitle").html(t.subtitle),a(".js-inspiro-starter-sites-importing").hide(),a(".js-inspiro-starter-sites-imported").show(),a(document).trigger("issImportComplete")):(a(".js-inspiro-starter-sites-ajax-complete-response").append('<img class="inspiro-starter-sites-imported-content-imported inspiro-starter-sites-imported-content-imported--error" src="'+inspiro_starter_sites.plugin_url+'assets/images/error.svg" alt="'+inspiro_starter_sites.texts.import_failed+'"><p>'+t+"</p>"),a(".js-inspiro-starter-sites-ajax-response-title").html(inspiro_starter_sites.texts.import_failed),a(".js-inspiro-starter-sites-ajax-response-subtitle").html("<p>"+inspiro_starter_sites.texts.import_failed_subtitle+"</p>"),a(".js-inspiro-starter-sites-importing").hide(),a(".js-inspiro-starter-sites-imported").show())}).fail(function(t){a(".js-inspiro-starter-sites-ajax-complete-response").append('<img class="inspiro-starter-sites-imported-content-imported inspiro-starter-sites-imported-content-imported--error" src="'+inspiro_starter_sites.plugin_url+'assets/images/error.svg" alt="'+inspiro_starter_sites.texts.import_failed+'"><p>Error: '+t.statusText+" ("+t.status+")</p>"),a(".js-inspiro-starter-sites-ajax-response-title").html(inspiro_starter_sites.texts.import_failed),a(".js-inspiro-starter-sites-ajax-response-subtitle").html("<p>"+inspiro_starter_sites.texts.import_failed_subtitle+"</p>"),a(".js-inspiro-starter-sites-importing").hide(),a(".js-inspiro-starter-sites-imported").show()})}(s)}a(".js-inspiro-starter-sites-notice-wrapper").appendTo(".js-inspiro-starter-sites-admin-notices-container"),a("#tabs").tabs({beforeLoad:function(t,s){return!1},create:function(t,s){a(".notice-dismiss, .tgmpa-dismiss").on("click",function(t){t.preventDefault();var s=a(this),t=s.attr("href");a.get(t,function(t){s.closest(".notice").fadeOut()})})}}),a('.wpz-onboard_tab a[href^="http"], .wpz-onboard_tab a[href*="admin.php"]').on("click",function(t){t.stopPropagation()}),a(".inspiro-starter-sites-install-plugins-content-content .plugin-item.plugin-item--required input[type=checkbox]").on("click",function(t){return t.preventDefault(),!1}),a(".js-inspiro-starter-sites-install-plugins").on("click",function(t){t.preventDefault();var s,t=a(this);return!t.hasClass("inspiro-starter-sites-button-disabled")&&0!==(s=a(".inspiro-starter-sites-install-plugins-content-content .plugin-item input[type=checkbox]").serializeArray()).length&&(t.addClass("inspiro-starter-sites-button-disabled"),void d(s,0,t,!1,!1))}),a(".js-inspiro-starter-sites-install-plugins-before-import").on("click",function(t){t.preventDefault();var s=a(this);if(s.hasClass("inspiro-starter-sites-button-disabled"))return!1;var e,i,t=a(".inspiro-starter-sites-install-theme-content"),r=a(".inspiro-starter-sites-install-plugins-content-content .plugin-item:not(.plugin-item--disabled) input[type=checkbox]").serializeArray();void 0!==t&&0<t.length&&(e=t.find("input[type=checkbox]:checked").val(),i=t.find(".theme-item"),void 0!==e)&&0<e.length?a.ajax({method:"POST",url:inspiro_starter_sites.ajax_url,data:{action:"handle_inspiro_theme",security:inspiro_starter_sites.ajax_nonce},beforeSend:function(){i.addClass("theme-item--loading")}}).done(function(t){if(i.removeClass("theme-item--loading"),t.success)return i.addClass("theme-item--active"),i.find("input[type=checkbox]").prop("disabled",!0),n(s,r),console.log("Theme activated successfully."),!1;console.log(t.data||"Failed to activate theme."),s.removeClass("inspiro-starter-sites-button-disabled")}).fail(function(t){console.log("Error: "+t.statusText+" ("+t.status+")"),n(s,r)}):n(s,r)}),a(document).on("change",".inspiro-starter-sites--create-content .content-item input[type=checkbox]",function(t){var s=a(".inspiro-starter-sites--create-content .content-item input[type=checkbox]"),e=a(".js-inspiro-starter-sites-create-content-install-plugins-notice"),i=[];s.each(function(){var s,e,t=a(this);t.is(":checked")&&(i=i.concat((s=(s=t.data("plugins")).split(","),e=[],inspiro_starter_sites.missing_plugins.forEach(function(t){-1!==s.indexOf(t.slug)&&e.push(t.name)}),e)))}),0<(i=i.filter(l).join(", ")).length?(e.find(".js-inspiro-starter-sites-create-content-install-plugins-list").text(i),e.show()):(e.find(".js-inspiro-starter-sites-create-content-install-plugins-list").text(""),e.hide())}),a(".js-inspiro-starter-sites-delete-imported-demo").on("click",function(t){t.preventDefault();t=a(this);if(t.hasClass("inspiro-starter-sites-button-disabled"))return!1;t.addClass("inspiro-starter-sites-button-disabled"),a.ajax({method:"POST",url:inspiro_starter_sites.ajax_url,data:{action:"inspiro_starter_sites_delete_imported_demo",security:inspiro_starter_sites.ajax_nonce},beforeSend:function(){a(".js-inspiro-starter-sites-delete-imported-content").hide(),a(".js-inspiro-starter-sites-deleting").show()}}).done(function(t){t.success||console.log(t.data||"Failed to delete imported content."),a(".js-inspiro-starter-sites-deleting").hide(),a(".js-inspiro-starter-sites-deleted").show()})}),r=a(".js-inspiro-starter-sites-gl-item-container").find(".js-inspiro-starter-sites-gl-item"),s="inspiro-starter-sites-is-fadeout",o="inspiro-starter-sites-is-fadein",p=200,a(".js-inspiro-starter-sites-nav-link").on("click",function(t){t.preventDefault(),a(this).parent().siblings().removeClass("active"),a(this).parent().addClass("active");var t=this.hash.slice(1),s=a(".js-inspiro-starter-sites-gl-item-container");s.css("min-width",s.outerHeight()),e(t).done(function(){s.removeAttr("style")})}),a(".js-inspiro-starter-sites-gl-search").on("keyup",function(t){(0<a(this).val().length?(a(".js-inspiro-starter-sites-gl-item-container").find(".js-inspiro-starter-sites-gl-item").hide(),a(".js-inspiro-starter-sites-gl-item-container").find('.js-inspiro-starter-sites-gl-item[data-name*="'+a(this).val().toLowerCase()+'"]')):a(".js-inspiro-starter-sites-gl-item-container").find(".js-inspiro-starter-sites-gl-item")).show()})});