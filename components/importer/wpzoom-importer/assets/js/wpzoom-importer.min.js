jQuery(function(s){function p(e,t){0===t.length?c(u("import")):(e.addClass("wpzi-button-disabled"),d(t,0,e,!0,!1))}function i(i){var e,n=jQuery.Deferred();return e=jQuery.Deferred(),a.addClass(t),setTimeout(function(){a.removeClass(t).hide(),e.resolve()},l),e.promise().done(function(){var e=i,t=n;e="all"!==e&&e?'[data-categories*="'+e+'"]':"div",a.filter(e).show().addClass("wpzi-is-fadein"),setTimeout(function(){a.removeClass(o),t.resolve()},l)}),n}var a,t,o,l;function r(e,t,i){return i.indexOf(e)===t}function d(e,t,i,n,a){var p=e[t].name;s.ajax({method:"POST",url:wpzi.ajax_url,data:{action:"wpzi_install_plugin",security:wpzi.ajax_nonce,slug:p},beforeSend:function(){var e=s(".plugin-item-"+p);e.find(".js-wpzi-plugin-item-info").empty(),e.find(".js-wpzi-plugin-item-error").empty(),e.addClass("plugin-item--loading")}}).done(function(e){var t=s(".plugin-item-"+p);t.removeClass("plugin-item--loading"),e.success?(t.addClass("plugin-item--active"),t.find("input[type=checkbox]").prop("disabled",!0)):(-1===e.data.indexOf("<p>")&&(e.data="<p>"+e.data+"</p>"),t.find(".js-wpzi-plugin-item-error").append(e.data),t.find("input[type=checkbox]").prop("checked",!1),a=!0)}).fail(function(e){var t=s(".plugin-item-"+p);t.removeClass("plugin-item--loading"),t.find(".js-wpzi-plugin-item-error").append("<p>"+e.statusText+" ("+e.status+")</p>"),a=!0}).always(function(){++t===e.length?(n&&(a?alert(wpzi.texts.plugin_install_failed):c(u("import"))),i.removeClass("wpzi-button-disabled")):d(e,t,i,n,a)})}function u(e){for(var t,i=window.location.search.substring(1).split("&"),n=0;n<i.length;n++)if((t=i[n].split("="))[0]===e)return t[1],decodeURIComponent(t[1]);return!1}function c(e){var t=new FormData;t.append("action","wpzi_import_demo_data"),t.append("security",wpzi.ajax_nonce),e&&t.append("selected",e),function i(n){s.ajax({method:"POST",url:wpzi.ajax_url,data:n,contentType:!1,processData:!1,beforeSend:function(){s(".js-wpzi-install-plugins-content").hide(),s(".js-wpzi-importing").show()}}).done(function(e){var t;void 0!==e.status&&"newAJAX"===e.status?i(n):void 0!==e.status&&"customizerAJAX"===e.status?((t=new FormData).append("action","wpzi_import_customizer_data"),t.append("security",wpzi.ajax_nonce),!0===wpzi.wp_customize_on&&t.append("wp_customize","on"),i(t)):void 0!==e.status&&"afterAllImportAJAX"===e.status?((t=new FormData).append("action","wpzi_after_import_data"),t.append("security",wpzi.ajax_nonce),i(t)):void 0!==e.message?(s(".js-wpzi-ajax-complete-response").append(e.message),void 0!==e.title&&s(".js-wpzi-ajax-response-title").html(e.title),void 0!==e.subtitle&&s(".js-wpzi-ajax-response-subtitle").html(e.subtitle),s(".js-wpzi-importing").hide(),s(".js-wpzi-imported").show(),s(document).trigger("wpziImportComplete")):(s(".js-wpzi-ajax-complete-response").append('<img class="wpzi-imported-content-imported wpzi-imported-content-imported--error" src="'+wpzi.plugin_url+'assets/images/error.svg" alt="'+wpzi.texts.import_failed+'"><p>'+e+"</p>"),s(".js-wpzi-ajax-response-title").html(wpzi.texts.import_failed),s(".js-wpzi-ajax-response-subtitle").html("<p>"+wpzi.texts.import_failed_subtitle+"</p>"),s(".js-wpzi-importing").hide(),s(".js-wpzi-imported").show())}).fail(function(e){s(".js-wpzi-ajax-complete-response").append('<img class="wpzi-imported-content-imported wpzi-imported-content-imported--error" src="'+wpzi.plugin_url+'assets/images/error.svg" alt="'+wpzi.texts.import_failed+'"><p>Error: '+e.statusText+" ("+e.status+")</p>"),s(".js-wpzi-ajax-response-title").html(wpzi.texts.import_failed),s(".js-wpzi-ajax-response-subtitle").html("<p>"+wpzi.texts.import_failed_subtitle+"</p>"),s(".js-wpzi-importing").hide(),s(".js-wpzi-imported").show()})}(t)}s(".js-wpzi-notice-wrapper").appendTo(".js-wpzi-admin-notices-container"),s(".js-wpzi-auto-start-manual-import").length&&c(!1),s(".js-wpzi-start-manual-import").on("click",function(e){e.preventDefault();var t=s(this);if(t.hasClass("wpzi-button-disabled"))return!1;e=new FormData;if(e.append("action","wpzi_upload_manual_import_files"),e.append("security",wpzi.ajax_nonce),s("#wpzi__content-file-upload").length&&s("#wpzi__content-file-upload").get(0).files.length){var i=s("#wpzi__content-file-upload")[0].files[0],n=i.name.split(".").pop();if(-1===["xml"].indexOf(n.toLowerCase()))return alert(wpzi.texts.content_filetype_warn),!1;e.append("content_file",i)}if(s("#wpzi__widget-file-upload").length&&s("#wpzi__widget-file-upload").get(0).files.length){n=s("#wpzi__widget-file-upload")[0].files[0],i=n.name.split(".").pop();if(-1===["json","wie"].indexOf(i.toLowerCase()))return alert(wpzi.texts.widgets_filetype_warn),!1;e.append("widget_file",n)}if(s("#wpzi__customizer-file-upload").length&&s("#wpzi__customizer-file-upload").get(0).files.length){i=s("#wpzi__customizer-file-upload")[0].files[0],n=i.name.split(".").pop();if(-1===["dat"].indexOf(n.toLowerCase()))return alert(wpzi.texts.customizer_filetype_warn),!1;e.append("customizer_file",i)}if(s("#wpzi__redux-file-upload").length&&s("#wpzi__redux-file-upload").get(0).files.length){n=s("#wpzi__redux-file-upload")[0].files[0],i=n.name.split(".").pop();if(-1===["json"].indexOf(i.toLowerCase()))return alert(wpzi.texts.redux_filetype_warn),!1;e.append("redux_file",n),e.append("redux_option_name",s("#wpzi__redux-option-name").val())}t.addClass("wpzi-button-disabled"),s.ajax({method:"POST",url:wpzi.ajax_url,data:e,contentType:!1,processData:!1}).done(function(e){e.success?window.location.href=wpzi.import_url:(alert(e.data),t.removeClass("wpzi-button-disabled"))}).fail(function(e){alert(e.statusText+" ("+e.status+")"),t.removeClass("wpzi-button-disabled")})}),s(".wpzi-install-plugins-content-content .plugin-item.plugin-item--required input[type=checkbox]").on("click",function(e){return e.preventDefault(),!1}),s(".js-wpzi-install-plugins").on("click",function(e){e.preventDefault();var t,e=s(this);return!e.hasClass("wpzi-button-disabled")&&0!==(t=s(".wpzi-install-plugins-content-content .plugin-item input[type=checkbox]").serializeArray()).length&&(e.addClass("wpzi-button-disabled"),void d(t,0,e,!1,!1))}),s(".js-wpzi-install-plugins-before-import").on("click",function(e){e.preventDefault();var t=s(this);if(t.hasClass("wpzi-button-disabled"))return!1;var i,n,e=s(".wpzi-install-theme-content"),a=s(".wpzi-install-plugins-content-content .plugin-item:not(.plugin-item--disabled) input[type=checkbox]").serializeArray();void 0!==e&&0<e.length&&(i=e.find("input[type=checkbox]:checked").val(),n=e.find(".theme-item"),void 0!==i)&&0<i.length?s.ajax({method:"POST",url:wpzi.ajax_url,data:{action:"handle_inspiro_theme",security:wpzi.ajax_nonce},beforeSend:function(){n.addClass("theme-item--loading")}}).done(function(e){if(n.removeClass("theme-item--loading"),e.success)return n.addClass("theme-item--active"),n.find("input[type=checkbox]").prop("disabled",!0),p(t,a),console.log("Theme activated successfully."),!1;console.log(e.data||"Failed to activate theme."),t.removeClass("wpzi-button-disabled")}).fail(function(e){console.log("Error: "+e.statusText+" ("+e.status+")"),p(t,a)}):p(t,a)}),s(document).on("change",".wpzi--create-content .content-item input[type=checkbox]",function(e){var t=s(".wpzi--create-content .content-item input[type=checkbox]"),i=s(".js-wpzi-create-content-install-plugins-notice"),n=[];t.each(function(){var t,i,e=s(this);e.is(":checked")&&(n=n.concat((t=(t=e.data("plugins")).split(","),i=[],wpzi.missing_plugins.forEach(function(e){-1!==t.indexOf(e.slug)&&i.push(e.name)}),i)))}),0<(n=n.filter(r).join(", ")).length?(i.find(".js-wpzi-create-content-install-plugins-list").text(n),i.show()):(i.find(".js-wpzi-create-content-install-plugins-list").text(""),i.hide())}),a=s(".js-wpzi-gl-item-container").find(".js-wpzi-gl-item"),t="wpzi-is-fadeout",o="wpzi-is-fadein",l=200,s(".js-wpzi-nav-link").on("click",function(e){e.preventDefault(),s(this).parent().siblings().removeClass("active"),s(this).parent().addClass("active");var e=this.hash.slice(1),t=s(".js-wpzi-gl-item-container");t.css("min-width",t.outerHeight()),i(e).done(function(){t.removeAttr("style")})}),s(".js-wpzi-gl-search").on("keyup",function(e){(0<s(this).val().length?(s(".js-wpzi-gl-item-container").find(".js-wpzi-gl-item").hide(),s(".js-wpzi-gl-item-container").find('.js-wpzi-gl-item[data-name*="'+s(this).val().toLowerCase()+'"]')):s(".js-wpzi-gl-item-container").find(".js-wpzi-gl-item")).show()})});