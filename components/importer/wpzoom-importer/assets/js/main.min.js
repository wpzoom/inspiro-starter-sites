jQuery(function(o){function i(i){var t,n=jQuery.Deferred();return t=jQuery.Deferred(),a.addClass(e),setTimeout(function(){a.removeClass(e).hide(),t.resolve()},p),t.promise().done(function(){var t=i,e=n;t="all"!==t&&t?'[data-categories*="'+t+'"]':"div",a.filter(t).show().addClass("wpzi-is-fadein"),setTimeout(function(){a.removeClass(s),e.resolve()},p)}),n}var a,e,s,p;function l(t,e,i){return i.indexOf(t)===e}function r(t,e,i,n,a){var s=t[e].name;o.ajax({method:"POST",url:wpzi.ajax_url,data:{action:"wpzi_install_plugin",security:wpzi.ajax_nonce,slug:s},beforeSend:function(){var t=o(".plugin-item-"+s);t.find(".js-wpzi-plugin-item-info").empty(),t.find(".js-wpzi-plugin-item-error").empty(),t.addClass("plugin-item--loading")}}).done(function(t){var e=o(".plugin-item-"+s);e.removeClass("plugin-item--loading"),t.success?(e.addClass("plugin-item--active"),e.find("input[type=checkbox]").prop("disabled",!0)):(-1===t.data.indexOf("<p>")&&(t.data="<p>"+t.data+"</p>"),e.find(".js-wpzi-plugin-item-error").append(t.data),e.find("input[type=checkbox]").prop("checked",!1),a=!0)}).fail(function(t){var e=o(".plugin-item-"+s);e.removeClass("plugin-item--loading"),e.find(".js-wpzi-plugin-item-error").append("<p>"+t.statusText+" ("+t.status+")</p>"),a=!0}).always(function(){++e===t.length?(n&&(a?alert(wpzi.texts.plugin_install_failed):u(d("import"))),i.removeClass("wpzi-button-disabled")):r(t,e,i,n,a)})}function d(t){for(var e,i=window.location.search.substring(1).split("&"),n=0;n<i.length;n++)if((e=i[n].split("="))[0]===t)return e[1],decodeURIComponent(e[1]);return!1}function u(t){var e=new FormData;e.append("action","wpzi_import_demo_data"),e.append("security",wpzi.ajax_nonce),t&&e.append("selected",t),function i(n){o.ajax({method:"POST",url:wpzi.ajax_url,data:n,contentType:!1,processData:!1,beforeSend:function(){o(".js-wpzi-install-plugins-content").hide(),o(".js-wpzi-importing").show()}}).done(function(t){var e;void 0!==t.status&&"newAJAX"===t.status?i(n):void 0!==t.status&&"customizerAJAX"===t.status?((e=new FormData).append("action","wpzi_import_customizer_data"),e.append("security",wpzi.ajax_nonce),!0===wpzi.wp_customize_on&&e.append("wp_customize","on"),i(e)):void 0!==t.status&&"afterAllImportAJAX"===t.status?((e=new FormData).append("action","wpzi_after_import_data"),e.append("security",wpzi.ajax_nonce),i(e)):void 0!==t.message?(o(".js-wpzi-ajax-complete-response").append(t.message),void 0!==t.title&&o(".js-wpzi-ajax-response-title").html(t.title),void 0!==t.subtitle&&o(".js-wpzi-ajax-response-subtitle").html(t.subtitle),o(".js-wpzi-importing").hide(),o(".js-wpzi-imported").show(),o(document).trigger("wpziImportComplete")):(o(".js-wpzi-ajax-complete-response").append('<img class="wpzi-imported-content-imported wpzi-imported-content-imported--error" src="'+wpzi.plugin_url+'assets/images/error.svg" alt="'+wpzi.texts.import_failed+'"><p>'+t+"</p>"),o(".js-wpzi-ajax-response-title").html(wpzi.texts.import_failed),o(".js-wpzi-ajax-response-subtitle").html("<p>"+wpzi.texts.import_failed_subtitle+"</p>"),o(".js-wpzi-importing").hide(),o(".js-wpzi-imported").show())}).fail(function(t){o(".js-wpzi-ajax-complete-response").append('<img class="wpzi-imported-content-imported wpzi-imported-content-imported--error" src="'+wpzi.plugin_url+'assets/images/error.svg" alt="'+wpzi.texts.import_failed+'"><p>Error: '+t.statusText+" ("+t.status+")</p>"),o(".js-wpzi-ajax-response-title").html(wpzi.texts.import_failed),o(".js-wpzi-ajax-response-subtitle").html("<p>"+wpzi.texts.import_failed_subtitle+"</p>"),o(".js-wpzi-importing").hide(),o(".js-wpzi-imported").show()})}(e)}o(".js-wpzi-notice-wrapper").appendTo(".js-wpzi-admin-notices-container"),o(".js-wpzi-auto-start-manual-import").length&&u(!1),o(".js-wpzi-start-manual-import").on("click",function(t){t.preventDefault();var e=o(this);if(e.hasClass("wpzi-button-disabled"))return!1;t=new FormData;if(t.append("action","wpzi_upload_manual_import_files"),t.append("security",wpzi.ajax_nonce),o("#wpzi__content-file-upload").length&&o("#wpzi__content-file-upload").get(0).files.length){var i=o("#wpzi__content-file-upload")[0].files[0],n=i.name.split(".").pop();if(-1===["xml"].indexOf(n.toLowerCase()))return alert(wpzi.texts.content_filetype_warn),!1;t.append("content_file",i)}if(o("#wpzi__widget-file-upload").length&&o("#wpzi__widget-file-upload").get(0).files.length){n=o("#wpzi__widget-file-upload")[0].files[0],i=n.name.split(".").pop();if(-1===["json","wie"].indexOf(i.toLowerCase()))return alert(wpzi.texts.widgets_filetype_warn),!1;t.append("widget_file",n)}if(o("#wpzi__customizer-file-upload").length&&o("#wpzi__customizer-file-upload").get(0).files.length){i=o("#wpzi__customizer-file-upload")[0].files[0],n=i.name.split(".").pop();if(-1===["dat"].indexOf(n.toLowerCase()))return alert(wpzi.texts.customizer_filetype_warn),!1;t.append("customizer_file",i)}if(o("#wpzi__redux-file-upload").length&&o("#wpzi__redux-file-upload").get(0).files.length){n=o("#wpzi__redux-file-upload")[0].files[0],i=n.name.split(".").pop();if(-1===["json"].indexOf(i.toLowerCase()))return alert(wpzi.texts.redux_filetype_warn),!1;t.append("redux_file",n),t.append("redux_option_name",o("#wpzi__redux-option-name").val())}e.addClass("wpzi-button-disabled"),o.ajax({method:"POST",url:wpzi.ajax_url,data:t,contentType:!1,processData:!1}).done(function(t){t.success?window.location.href=wpzi.import_url:(alert(t.data),e.removeClass("wpzi-button-disabled"))}).fail(function(t){alert(t.statusText+" ("+t.status+")"),e.removeClass("wpzi-button-disabled")})}),o(".js-wpzi-cancel-manual-import").on("click",function(){o(".wpzi__file-upload-container-items input[type=file]").each(function(){o(this).val("").trigger("change")})}),o(document).on("change",".wpzi__file-upload-container-items input[type=file]",function(){var t=o(this),e=t.siblings("label"),i=!1;this.files&&0<this.files.length?(t.removeClass("wpzi-hide-input").blur(),e.hide()):(t.addClass("wpzi-hide-input"),e.show()),o(".wpzi__file-upload-container-items input[type=file]").each(function(){this.files&&0<this.files.length&&(i=!0)}),o(".js-wpzi-start-manual-import").prop("disabled",!i),o(".js-wpzi-cancel-manual-import").prop("disabled",!i)}),o(".wpzi-install-plugins-content-content .plugin-item.plugin-item--required input[type=checkbox]").on("click",function(t){return t.preventDefault(),!1}),o(".js-wpzi-install-plugins").on("click",function(t){t.preventDefault();var e,t=o(this);return!t.hasClass("wpzi-button-disabled")&&0!==(e=o(".wpzi-install-plugins-content-content .plugin-item input[type=checkbox]").serializeArray()).length&&(t.addClass("wpzi-button-disabled"),void r(e,0,t,!1,!1))}),o(".js-wpzi-install-plugins-before-import").on("click",function(t){t.preventDefault();var e,t=o(this);return!t.hasClass("wpzi-button-disabled")&&(0===(e=o(".wpzi-install-plugins-content-content .plugin-item:not(.plugin-item--disabled) input[type=checkbox]").serializeArray()).length?(u(d("import")),!1):(t.addClass("wpzi-button-disabled"),void r(e,0,t,!0,!1)))}),o(".js-wpzi-create-content").on("click",function(t){t.preventDefault();var e,t=o(this);return!t.hasClass("wpzi-button-disabled")&&0!==(e=o(".wpzi-create-content-content .content-item input[type=checkbox]").serializeArray()).length&&(t.addClass("wpzi-button-disabled"),void function i(n,a,s){var t=n[a],p=t.name;o.ajax({method:"POST",url:wpzi.ajax_url,data:{action:"wpzi_import_created_content",security:wpzi.ajax_nonce,slug:p},beforeSend:function(){var t=o(".content-item-"+p);t.find(".js-wpzi-content-item-info").empty(),t.find(".js-wpzi-content-item-error").empty(),t.addClass("content-item--loading")}}).done(function(t){var e;t.data&&t.data.refresh?i(n,a,s):((e=o(".content-item-"+p)).removeClass("content-item--loading"),t.success?e.find(".js-wpzi-content-item-info").append("<p>"+wpzi.texts.successful_import+"</p>"):e.find(".js-wpzi-content-item-error").append("<p>"+t.data+"</p>"))}).fail(function(t){var e=o(".content-item-"+p);e.removeClass("content-item--loading"),e.find(".js-wpzi-content-item-error").append("<p>"+t.statusText+" ("+t.status+")</p>")}).always(function(t){t.data&&t.data.refresh||(++a===n.length?s.removeClass("wpzi-button-disabled"):i(n,a,s))})}(e,0,t))}),o(".js-wpzi-install-coming-soon-plugin").on("click",function(t){t.preventDefault();var e=o(this);if(e.hasClass("button-disabled"))return!1;e.addClass("button-disabled"),o.ajax({method:"POST",url:wpzi.ajax_url,data:{action:"wpzi_install_plugin",security:wpzi.ajax_nonce,slug:"coming-soon"},beforeSend:function(){e.text(wpzi.texts.installing)}}).done(function(t){t.success?e.text(wpzi.texts.installed):(alert(t.data),e.text(wpzi.texts.install_plugin),e.removeClass("button-disabled"))}).fail(function(t){alert(t.statusText+" ("+t.status+")"),e.removeClass("button-disabled")})}),o(document).on("change",".wpzi--create-content .content-item input[type=checkbox]",function(t){var e=o(".wpzi--create-content .content-item input[type=checkbox]"),i=o(".js-wpzi-create-content-install-plugins-notice"),n=[];e.each(function(){var e,i,t=o(this);t.is(":checked")&&(n=n.concat((e=(e=t.data("plugins")).split(","),i=[],wpzi.missing_plugins.forEach(function(t){-1!==e.indexOf(t.slug)&&i.push(t.name)}),i)))}),0<(n=n.filter(l).join(", ")).length?(i.find(".js-wpzi-create-content-install-plugins-list").text(n),i.show()):(i.find(".js-wpzi-create-content-install-plugins-list").text(""),i.hide())}),a=o(".js-wpzi-gl-item-container").find(".js-wpzi-gl-item"),e="wpzi-is-fadeout",s="wpzi-is-fadein",p=200,o(".js-wpzi-nav-link").on("click",function(t){t.preventDefault(),o(this).parent().siblings().removeClass("active"),o(this).parent().addClass("active");var t=this.hash.slice(1),e=o(".js-wpzi-gl-item-container");e.css("min-width",e.outerHeight()),i(t).done(function(){e.removeAttr("style")})}),o(".js-wpzi-gl-search").on("keyup",function(t){(0<o(this).val().length?(o(".js-wpzi-gl-item-container").find(".js-wpzi-gl-item").hide(),o(".js-wpzi-gl-item-container").find('.js-wpzi-gl-item[data-name*="'+o(this).val().toLowerCase()+'"]')):o(".js-wpzi-gl-item-container").find(".js-wpzi-gl-item")).show()})});